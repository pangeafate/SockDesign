(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{365:(e,t,a)=>{Promise.resolve().then(a.bind(a,6022))},6022:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(5155),l=a(2115);function n(){let[e,t]=(0,l.useState)(null),[a,n]=(0,l.useState)(32),[s,i]=(0,l.useState)(8),[o,c]=(0,l.useState)(null),[d,h]=(0,l.useState)([]),[u,g]=(0,l.useState)("#000000"),[p,f]=(0,l.useState)(!1),[m,x]=(0,l.useState)(null),b=(0,l.useRef)(null),v=(0,l.useRef)(null),w=(e,t)=>Math.sqrt(Math.pow(e.r-t.r,2)+Math.pow(e.g-t.g,2)+Math.pow(e.b-t.b,2)),j=(e,t)=>{let a=[];for(let t=0;t<e.data.length;t+=4)e.data[t+3]>128&&a.push({r:e.data[t],g:e.data[t+1],b:e.data[t+2],a:e.data[t+3]});if(0===a.length)return[];let r=[];for(let e=0;e<t;e++){let e=a[Math.floor(Math.random()*a.length)];r.push({...e})}for(let e=0;e<20;e++){let e=Array(t).fill(null).map(()=>[]);a.forEach(t=>{let a=1/0,l=0;r.forEach((e,r)=>{let n=w(t,e);n<a&&(a=n,l=r)}),e[l].push(t)}),r.forEach((t,a)=>{e[a].length>0&&(t.r=e[a].reduce((e,t)=>e+t.r,0)/e[a].length,t.g=e[a].reduce((e,t)=>e+t.g,0)/e[a].length,t.b=e[a].reduce((e,t)=>e+t.b,0)/e[a].length)})}return r.map(e=>"#".concat(Math.round(e.r).toString(16).padStart(2,"0")).concat(Math.round(e.g).toString(16).padStart(2,"0")).concat(Math.round(e.b).toString(16).padStart(2,"0")))},I=(0,l.useCallback)(()=>{if(!e||!b.current)return;let t=b.current,r=t.getContext("2d");if(!r)return;let l=Math.round(400*e.height/e.width);t.width=a,t.height=Math.round(a*e.height/e.width),t.style.width="".concat(400,"px"),t.style.height="".concat(l,"px"),r.imageSmoothingEnabled=!1,r.drawImage(e,0,0,t.width,t.height);let n=r.getImageData(0,0,t.width,t.height),i=j(n,s);h(i);let o=n.data;for(let e=0;e<o.length;e+=4)if(o[e+3]>128){let t={r:o[e],g:o[e+1],b:o[e+2],a:o[e+3]},a=1/0,r=i[0];i.forEach(e=>{let l=w(t,{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:255});l<a&&(a=l,r=e)});let l=parseInt(r.slice(1,3),16),n=parseInt(r.slice(3,5),16),s=parseInt(r.slice(5,7),16);o[e]=l,o[e+1]=n,o[e+2]=s}r.putImageData(n,0,0),c(n)},[e,a,s]),M=(e,t)=>{let a=[...d],r=a[e];if(a[e]=t,h(a),!b.current||!o)return;let l=b.current,n=l.getContext("2d");if(!n)return;let s=n.getImageData(0,0,l.width,l.height),i=s.data,u={r:parseInt(r.slice(1,3),16),g:parseInt(r.slice(3,5),16),b:parseInt(r.slice(5,7),16)},g={r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16)};for(let e=0;e<i.length;e+=4)i[e]===u.r&&i[e+1]===u.g&&i[e+2]===u.b&&(i[e]=g.r,i[e+1]=g.g,i[e+2]=g.b);n.putImageData(s,0,0),c(s)};return(0,l.useEffect)(()=>{e&&I()},[e,I]),(0,r.jsxs)("div",{className:"main-content",children:[(0,r.jsx)("div",{className:"canvas-area ".concat(e?"has-content":""),children:e?(0,r.jsx)("div",{className:"canvas-container",children:(0,r.jsx)("canvas",{ref:b,onClick:e=>{if(!b.current||!o)return;let t=b.current,a=t.getBoundingClientRect(),r=t.width/a.width,l=t.height/a.height,n=Math.floor((e.clientX-a.left)*r),s=Math.floor((e.clientY-a.top)*l),i=t.getContext("2d");if(!i)return;let d=i.getImageData(0,0,t.width,t.height),h=d.data,g=parseInt(u.slice(1,3),16),p=parseInt(u.slice(3,5),16),f=parseInt(u.slice(5,7),16),m=(s*t.width+n)*4;h[m]=g,h[m+1]=p,h[m+2]=f,h[m+3]=255,i.putImageData(d,0,0),c(d)},style:{imageRendering:"pixelated",cursor:"crosshair",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px"}})}):(0,r.jsxs)("div",{className:"upload-area",onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let a=e.dataTransfer.files[0];if(a&&a.type.startsWith("image/")){let e=new FileReader;e.onload=e=>{var a;let r=new Image;r.onload=()=>t(r),r.src=null==(a=e.target)?void 0:a.result},e.readAsDataURL(a)}},onClick:()=>{var e;return null==(e=v.current)?void 0:e.click()},children:[(0,r.jsx)("p",{children:"Click to upload or drag and drop an image"}),(0,r.jsx)("input",{ref:v,type:"file",accept:"image/*",onChange:e=>{var a;let r=null==(a=e.target.files)?void 0:a[0];if(!r)return;let l=new FileReader;l.onload=e=>{var a;let r=new Image;r.onload=()=>{t(r)},r.src=null==(a=e.target)?void 0:a.result},l.readAsDataURL(r)},className:"file-input"})]})}),(0,r.jsxs)("div",{className:"controls-panel",children:[(0,r.jsxs)("div",{className:"control-group",children:[(0,r.jsx)("h3",{children:"Resolution"}),(0,r.jsxs)("div",{className:"slider",children:[(0,r.jsx)("input",{type:"range",min:"16",max:"128",value:a,onChange:e=>n(Number(e.target.value))}),(0,r.jsxs)("span",{children:[a,"px"]})]})]}),(0,r.jsxs)("div",{className:"control-group",children:[(0,r.jsx)("h3",{children:"Max Colors"}),(0,r.jsxs)("div",{className:"slider",children:[(0,r.jsx)("input",{type:"range",min:"2",max:"16",value:s,onChange:e=>i(Number(e.target.value))}),(0,r.jsxs)("span",{children:[s," colors"]})]})]}),d.length>0&&(0,r.jsxs)("div",{className:"control-group",children:[(0,r.jsx)("h3",{children:"Color Palette"}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(60px, 1fr))",gap:"10px"},children:d.map((e,t)=>(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px"},children:[(0,r.jsx)("div",{className:"color-swatch ".concat(u===e?"selected":""),style:{backgroundColor:e,position:"relative",width:"40px",height:"40px"},onClick:()=>g(e)}),(0,r.jsx)("input",{type:"color",value:e,onChange:e=>M(t,e.target.value),style:{width:"40px",height:"20px",border:"none",borderRadius:"4px",cursor:"pointer"},title:"Edit color"})]},t))})]}),(0,r.jsxs)("div",{className:"control-group",children:[(0,r.jsx)("h3",{children:"Actions"}),(0,r.jsx)("button",{className:"button",onClick:()=>{if(!b.current||!o)return;let e=b.current,t=e.getContext("2d");if(!t)return;let a=t.getImageData(0,0,e.width,e.height),r=a.data,l=[[r[0],r[1],r[2]],[r[(e.width-1)*4],r[(e.width-1)*4+1],r[(e.width-1)*4+2]],[r[(e.height-1)*e.width*4],r[(e.height-1)*e.width*4+1],r[(e.height-1)*e.width*4+2]]];for(let e=0;e<r.length;e+=4){let t=[r[e],r[e+1],r[e+2]];for(let a of l)if(50>Math.sqrt(Math.pow(t[0]-a[0],2)+Math.pow(t[1]-a[1],2)+Math.pow(t[2]-a[2],2))){r[e+3]=0;break}}t.putImageData(a,0,0),c(a)},disabled:!o,children:"Remove Background"}),(0,r.jsx)("button",{className:"button",onClick:()=>{if(!b.current)return;let e=document.createElement("a");e.download="pixelated-design.png",e.href=b.current.toDataURL(),e.click()},disabled:!o,children:"Download PNG"}),(0,r.jsx)("button",{className:"button",onClick:()=>{if(t(null),n(32),i(8),c(null),h([]),g("#000000"),f(!1),x(null),b.current){let e=b.current.getContext("2d");e&&e.clearRect(0,0,b.current.width,b.current.height)}},children:"Reset"})]})]})]})}function s(){let[e,t]=(0,l.useState)(null),[a,n]=(0,l.useState)(1024),[s,i]=(0,l.useState)(7),[o,c]=(0,l.useState)(null),[d,h]=(0,l.useState)([]),[u,g]=(0,l.useState)("#000000"),[p,f]=(0,l.useState)(!1),[m,x]=(0,l.useState)(null),b=(0,l.useRef)(!0),v=(0,l.useRef)([]),w=(0,l.useRef)(null),j=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=["/SockDesign/images/default-sock.png","./images/default-sock.png","/images/default-sock.png","images/default-sock.png"],a=0,r=()=>{if(a>=e.length)return void console.error("Failed to load default sock image from all paths");let l=new Image;l.onload=()=>{console.log("Successfully loaded image from: ".concat(e[a])),b.current=!0,t(l)},l.onerror=t=>{console.log("Failed to load from ".concat(e[a],", trying next path...")),a++,r()},l.src=e[a]};r()},[]);let I=(e,t)=>Math.sqrt(Math.pow(e.r-t.r,2)+Math.pow(e.g-t.g,2)+Math.pow(e.b-t.b,2)),M=(e,t)=>{let a=[];for(let t=0;t<e.data.length;t+=4)e.data[t+3]>128&&a.push({r:e.data[t],g:e.data[t+1],b:e.data[t+2],a:e.data[t+3]});if(0===a.length)return[];let r=new Map;a.forEach(e=>{let t={r:8*Math.round(e.r/8),g:8*Math.round(e.g/8),b:8*Math.round(e.b/8),a:e.a},a="".concat(t.r,"-").concat(t.g,"-").concat(t.b);r.has(a)?r.get(a).count++:r.set(a,{color:t,count:1})});let l=Array.from(r.values()).sort((e,t)=>t.count-e.count).slice(0,t).map(e=>({...e.color}));for(;l.length<t;){let e=a.filter(e=>!l.some(t=>16>Math.abs(e.r-t.r)&&16>Math.abs(e.g-t.g)&&16>Math.abs(e.b-t.b)));if(e.length>0){let a=Math.floor(e.length/(t-l.length+1));l.push({...e[a]})}else{let e=l[l.length%l.length];l.push({r:Math.min(255,Math.max(0,e.r+20*l.length)),g:Math.min(255,Math.max(0,e.g+20*l.length)),b:Math.min(255,Math.max(0,e.b+20*l.length)),a:e.a})}}for(let e=0;e<15;e++){let e=Array(t).fill(null).map(()=>[]);a.forEach(t=>{let a=1/0,r=0;l.forEach((e,l)=>{let n=I(t,e);n<a&&(a=n,r=l)}),e[r].push(t)});let r=!1;if(l.forEach((t,a)=>{if(e[a].length>0){let l=e[a].reduce((e,t)=>e+t.r,0)/e[a].length,n=e[a].reduce((e,t)=>e+t.g,0)/e[a].length,s=e[a].reduce((e,t)=>e+t.b,0)/e[a].length;(Math.abs(t.r-l)>1||Math.abs(t.g-n)>1||Math.abs(t.b-s)>1)&&(r=!0),t.r=l,t.g=n,t.b=s}}),!r)break}return l.map(e=>"#".concat(Math.round(e.r).toString(16).padStart(2,"0")).concat(Math.round(e.g).toString(16).padStart(2,"0")).concat(Math.round(e.b).toString(16).padStart(2,"0")))},C=(0,l.useCallback)(()=>{if(!e||!w.current)return;let t=w.current,r=t.getContext("2d");if(!r)return;let l=Math.round(600*e.height/e.width);t.width=a,t.height=Math.round(a*e.height/e.width),t.style.width="".concat(600,"px"),t.style.height="".concat(l,"px"),r.imageSmoothingEnabled=!1,r.drawImage(e,0,0,t.width,t.height);let n=r.getImageData(0,0,t.width,t.height),i=v.current;(b.current||0===v.current.length)&&(h(i=M(n,s)),v.current=i,b.current=!1);let o=n.data;for(let e=0;e<o.length;e+=4)if(o[e+3]>128){let t={r:o[e],g:o[e+1],b:o[e+2],a:o[e+3]},a=1/0,r=i[0];i.forEach(e=>{let l=I(t,{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:255});l<a&&(a=l,r=e)});let l=parseInt(r.slice(1,3),16),n=parseInt(r.slice(3,5),16),s=parseInt(r.slice(5,7),16);o[e]=l,o[e+1]=n,o[e+2]=s}r.putImageData(n,0,0),c(n)},[e,a,s]),k=(e,t)=>{let a=[...d],r=a[e];if(a[e]=t,!w.current||!o)return;let l=w.current,n=l.getContext("2d");if(!n)return;let s=n.getImageData(0,0,l.width,l.height),i=s.data,u={r:parseInt(r.slice(1,3),16),g:parseInt(r.slice(3,5),16),b:parseInt(r.slice(5,7),16)},g={r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16)};for(let e=0;e<i.length;e+=4)i[e]===u.r&&i[e+1]===u.g&&i[e+2]===u.b&&(i[e]=g.r,i[e+1]=g.g,i[e+2]=g.b);n.putImageData(s,0,0),c(s),h(a),v.current=a};return(0,l.useEffect)(()=>{v.current=d},[d]),(0,l.useEffect)(()=>{e&&d.length>0&&(b.current=!0)},[s]),(0,l.useEffect)(()=>{e&&C()},[e,a,s]),(0,r.jsxs)("div",{className:"main-content",children:[(0,r.jsx)("div",{className:"canvas-area ".concat(e?"has-content":""),children:e?(0,r.jsx)("div",{className:"canvas-container",children:(0,r.jsx)("canvas",{ref:w,onClick:e=>{if(!w.current||!o)return;let t=w.current,a=t.getBoundingClientRect(),r=t.width/a.width,l=t.height/a.height,n=Math.floor((e.clientX-a.left)*r),s=Math.floor((e.clientY-a.top)*l),i=t.getContext("2d");if(!i)return;let d=i.getImageData(0,0,t.width,t.height),h=d.data,g=parseInt(u.slice(1,3),16),p=parseInt(u.slice(3,5),16),f=parseInt(u.slice(5,7),16),m=(s*t.width+n)*4;h[m]=g,h[m+1]=p,h[m+2]=f,h[m+3]=255,i.putImageData(d,0,0),c(d)},style:{imageRendering:"pixelated",cursor:"crosshair",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px"}})}):(0,r.jsxs)("div",{className:"upload-area",onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let a=e.dataTransfer.files[0];if(a&&a.type.startsWith("image/")){let e=new FileReader;e.onload=e=>{var a;let r=new Image;r.onload=()=>{b.current=!0,t(r)},r.src=null==(a=e.target)?void 0:a.result},e.readAsDataURL(a)}},onClick:()=>{var e;return null==(e=j.current)?void 0:e.click()},children:[(0,r.jsx)("p",{children:"Click to upload or drag and drop an image"}),(0,r.jsx)("input",{ref:j,type:"file",accept:"image/*",onChange:e=>{var a;let r=null==(a=e.target.files)?void 0:a[0];if(!r)return;let l=new FileReader;l.onload=e=>{var a;let r=new Image;r.onload=()=>{b.current=!0,t(r)},r.src=null==(a=e.target)?void 0:a.result},l.readAsDataURL(r)},className:"file-input"})]})}),(0,r.jsxs)("div",{className:"controls-panel",children:[(0,r.jsxs)("div",{className:"control-group",children:[(0,r.jsx)("h3",{children:"Resolution"}),(0,r.jsxs)("div",{className:"slider",children:[(0,r.jsx)("input",{type:"range",min:"640",max:"1024",value:a,onChange:e=>n(Number(e.target.value))}),(0,r.jsxs)("span",{children:[a,"px"]})]})]}),(0,r.jsxs)("div",{className:"control-group",children:[(0,r.jsx)("h3",{children:"Max Colors"}),(0,r.jsxs)("div",{className:"slider",children:[(0,r.jsx)("input",{type:"range",min:"3",max:"7",value:s,onChange:e=>i(Number(e.target.value))}),(0,r.jsxs)("span",{children:[s," colors"]})]})]}),d.length>0&&(0,r.jsxs)("div",{className:"control-group",children:[(0,r.jsx)("h3",{children:"Color Palette"}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(60px, 1fr))",gap:"10px"},children:d.map((e,t)=>(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px"},children:[(0,r.jsx)("div",{className:"color-swatch ".concat(u===e?"selected":""),style:{backgroundColor:e,position:"relative",width:"40px",height:"40px"},onClick:()=>g(e)}),(0,r.jsx)("input",{type:"color",value:e,onChange:e=>k(t,e.target.value),style:{width:"40px",height:"20px",border:"none",borderRadius:"4px",cursor:"pointer"},title:"Edit color"})]},t))})]}),(0,r.jsxs)("div",{className:"control-group",children:[(0,r.jsx)("h3",{children:"Actions"}),(0,r.jsx)("button",{className:"button",onClick:()=>{if(!w.current||!o)return;let e=w.current,t=e.getContext("2d");if(!t)return;let a=t.getImageData(0,0,e.width,e.height),r=a.data,l=[[r[0],r[1],r[2]],[r[(e.width-1)*4],r[(e.width-1)*4+1],r[(e.width-1)*4+2]],[r[(e.height-1)*e.width*4],r[(e.height-1)*e.width*4+1],r[(e.height-1)*e.width*4+2]]];for(let e=0;e<r.length;e+=4){let t=[r[e],r[e+1],r[e+2]];for(let a of l)if(50>Math.sqrt(Math.pow(t[0]-a[0],2)+Math.pow(t[1]-a[1],2)+Math.pow(t[2]-a[2],2))){r[e+3]=0;break}}t.putImageData(a,0,0),c(a)},disabled:!o,children:"Remove Background"}),(0,r.jsx)("button",{className:"button",onClick:()=>{if(!w.current)return;let e=document.createElement("a");e.download="pixelated-design.png",e.href=w.current.toDataURL(),e.click()},disabled:!o,children:"Download PNG"}),(0,r.jsx)("button",{className:"button",onClick:()=>{if(t(null),n(1024),i(7),c(null),h([]),g("#000000"),f(!1),x(null),b.current=!0,v.current=[],w.current){let e=w.current.getContext("2d");e&&e.clearRect(0,0,w.current.width,w.current.height)}setTimeout(()=>{let e=new Image;e.onload=()=>{b.current=!0,t(e)},e.onerror=e=>{console.error("Failed to load default sock image:",e)},e.src="/images/default-sock.png"},100)},children:"Reset"})]})]})]})}function i(){let[e,t]=(0,l.useState)("picture");return(0,r.jsxs)("div",{className:"container",children:[(0,r.jsxs)("div",{className:"header",children:[(0,r.jsx)("h1",{children:"Knitting Socks Designer"}),(0,r.jsx)("p",{children:"Create beautiful patterns and color designs for your knitting projects"})]}),(0,r.jsxs)("div",{className:"tabs",children:[(0,r.jsx)("button",{className:"tab-button ".concat("picture"===e?"active":""),onClick:()=>t("picture"),children:"Picture Design"}),(0,r.jsx)("button",{className:"tab-button ".concat("sock"===e?"active":""),onClick:()=>t("sock"),children:"Sock Color Design"})]}),(0,r.jsx)("div",{style:{display:"picture"===e?"block":"none"},children:(0,r.jsx)(n,{})}),(0,r.jsx)("div",{style:{display:"sock"===e?"block":"none"},children:(0,r.jsx)(s,{})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(365)),_N_E=e.O()}]);