(()=>{var e={};e.id=974,e.ids=[974],e.modules={132:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6444,23)),Promise.resolve().then(r.t.bind(r,6042,23)),Promise.resolve().then(r.t.bind(r,8170,23)),Promise.resolve().then(r.t.bind(r,9477,23)),Promise.resolve().then(r.t.bind(r,9345,23)),Promise.resolve().then(r.t.bind(r,2089,23)),Promise.resolve().then(r.t.bind(r,6577,23)),Promise.resolve().then(r.t.bind(r,1307,23))},405:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>h,pages:()=>c,routeModule:()=>u,tree:()=>d});var a=r(5239),n=r(8088),s=r(8170),l=r.n(s),i=r(893),o={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,597)),"/Users/sergeypodolskiy/CODEBASE/25 06 25 KnittingSocks/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,8014)),"/Users/sergeypodolskiy/CODEBASE/25 06 25 KnittingSocks/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}],c=["/Users/sergeypodolskiy/CODEBASE/25 06 25 KnittingSocks/app/page.tsx"],h={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},597:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/sergeypodolskiy/CODEBASE/25 06 25 KnittingSocks/app/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/sergeypodolskiy/CODEBASE/25 06 25 KnittingSocks/app/page.tsx","default")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2630:(e,t,r)=>{Promise.resolve().then(r.bind(r,597))},2704:()=>{},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4100:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6346,23)),Promise.resolve().then(r.t.bind(r,7924,23)),Promise.resolve().then(r.t.bind(r,5656,23)),Promise.resolve().then(r.t.bind(r,99,23)),Promise.resolve().then(r.t.bind(r,8243,23)),Promise.resolve().then(r.t.bind(r,8827,23)),Promise.resolve().then(r.t.bind(r,2763,23)),Promise.resolve().then(r.t.bind(r,7173,23))},4667:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var a=r(687),n=r(3210);function s(){let[e,t]=(0,n.useState)(null),[r,s]=(0,n.useState)(32),[l,i]=(0,n.useState)(8),[o,d]=(0,n.useState)(null),[c,h]=(0,n.useState)([]),[u,g]=(0,n.useState)("#000000"),[p,m]=(0,n.useState)(!1),[x,f]=(0,n.useState)(null),b=(0,n.useRef)(null),v=(0,n.useRef)(null),j=(e,t)=>Math.sqrt(Math.pow(e.r-t.r,2)+Math.pow(e.g-t.g,2)+Math.pow(e.b-t.b,2)),w=(e,t)=>{let r=[];for(let t=0;t<e.data.length;t+=4)e.data[t+3]>128&&r.push({r:e.data[t],g:e.data[t+1],b:e.data[t+2],a:e.data[t+3]});if(0===r.length)return[];let a=[];for(let e=0;e<t;e++){let e=r[Math.floor(Math.random()*r.length)];a.push({...e})}for(let e=0;e<20;e++){let e=Array(t).fill(null).map(()=>[]);r.forEach(t=>{let r=1/0,n=0;a.forEach((e,a)=>{let s=j(t,e);s<r&&(r=s,n=a)}),e[n].push(t)}),a.forEach((t,r)=>{e[r].length>0&&(t.r=e[r].reduce((e,t)=>e+t.r,0)/e[r].length,t.g=e[r].reduce((e,t)=>e+t.g,0)/e[r].length,t.b=e[r].reduce((e,t)=>e+t.b,0)/e[r].length)})}return a.map(e=>`#${Math.round(e.r).toString(16).padStart(2,"0")}${Math.round(e.g).toString(16).padStart(2,"0")}${Math.round(e.b).toString(16).padStart(2,"0")}`)};(0,n.useCallback)(()=>{if(!e||!b.current)return;let t=b.current,a=t.getContext("2d");if(!a)return;let n=Math.round(400*e.height/e.width);t.width=r,t.height=Math.round(r*e.height/e.width),t.style.width="400px",t.style.height=`${n}px`,a.imageSmoothingEnabled=!1,a.drawImage(e,0,0,t.width,t.height);let s=a.getImageData(0,0,t.width,t.height),i=w(s,l);h(i);let o=s.data;for(let e=0;e<o.length;e+=4)if(o[e+3]>128){let t={r:o[e],g:o[e+1],b:o[e+2],a:o[e+3]},r=1/0,a=i[0];i.forEach(e=>{let n=j(t,{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:255});n<r&&(r=n,a=e)});let n=parseInt(a.slice(1,3),16),s=parseInt(a.slice(3,5),16),l=parseInt(a.slice(5,7),16);o[e]=n,o[e+1]=s,o[e+2]=l}a.putImageData(s,0,0),d(s)},[e,r,l]);let k=(e,t)=>{let r=[...c],a=r[e];if(r[e]=t,h(r),!b.current||!o)return;let n=b.current,s=n.getContext("2d");if(!s)return;let l=s.getImageData(0,0,n.width,n.height),i=l.data,u={r:parseInt(a.slice(1,3),16),g:parseInt(a.slice(3,5),16),b:parseInt(a.slice(5,7),16)},g={r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16)};for(let e=0;e<i.length;e+=4)i[e]===u.r&&i[e+1]===u.g&&i[e+2]===u.b&&(i[e]=g.r,i[e+1]=g.g,i[e+2]=g.b);s.putImageData(l,0,0),d(l)};return(0,a.jsxs)("div",{className:"main-content",children:[(0,a.jsx)("div",{className:`canvas-area ${e?"has-content":""}`,children:e?(0,a.jsx)("div",{className:"canvas-container",children:(0,a.jsx)("canvas",{ref:b,onClick:e=>{if(!b.current||!o)return;let t=b.current,r=t.getBoundingClientRect(),a=t.width/r.width,n=t.height/r.height,s=Math.floor((e.clientX-r.left)*a),l=Math.floor((e.clientY-r.top)*n),i=t.getContext("2d");if(!i)return;let c=i.getImageData(0,0,t.width,t.height),h=c.data,g=parseInt(u.slice(1,3),16),p=parseInt(u.slice(3,5),16),m=parseInt(u.slice(5,7),16),x=(l*t.width+s)*4;h[x]=g,h[x+1]=p,h[x+2]=m,h[x+3]=255,i.putImageData(c,0,0),d(c)},style:{imageRendering:"pixelated",cursor:"crosshair",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px"}})}):(0,a.jsxs)("div",{className:"upload-area",onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let r=e.dataTransfer.files[0];if(r&&r.type.startsWith("image/")){let e=new FileReader;e.onload=e=>{let r=new Image;r.onload=()=>t(r),r.src=e.target?.result},e.readAsDataURL(r)}},onClick:()=>v.current?.click(),children:[(0,a.jsx)("p",{children:"Click to upload or drag and drop an image"}),(0,a.jsx)("input",{ref:v,type:"file",accept:"image/*",onChange:e=>{let r=e.target.files?.[0];if(!r)return;let a=new FileReader;a.onload=e=>{let r=new Image;r.onload=()=>{t(r)},r.src=e.target?.result},a.readAsDataURL(r)},className:"file-input"})]})}),(0,a.jsxs)("div",{className:"controls-panel",children:[(0,a.jsxs)("div",{className:"control-group",children:[(0,a.jsx)("h3",{children:"Resolution"}),(0,a.jsxs)("div",{className:"slider",children:[(0,a.jsx)("input",{type:"range",min:"16",max:"128",value:r,onChange:e=>s(Number(e.target.value))}),(0,a.jsxs)("span",{children:[r,"px"]})]})]}),(0,a.jsxs)("div",{className:"control-group",children:[(0,a.jsx)("h3",{children:"Max Colors"}),(0,a.jsxs)("div",{className:"slider",children:[(0,a.jsx)("input",{type:"range",min:"2",max:"16",value:l,onChange:e=>i(Number(e.target.value))}),(0,a.jsxs)("span",{children:[l," colors"]})]})]}),c.length>0&&(0,a.jsxs)("div",{className:"control-group",children:[(0,a.jsx)("h3",{children:"Color Palette"}),(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(60px, 1fr))",gap:"10px"},children:c.map((e,t)=>(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px"},children:[(0,a.jsx)("div",{className:`color-swatch ${u===e?"selected":""}`,style:{backgroundColor:e,position:"relative",width:"40px",height:"40px"},onClick:()=>g(e)}),(0,a.jsx)("input",{type:"color",value:e,onChange:e=>k(t,e.target.value),style:{width:"40px",height:"20px",border:"none",borderRadius:"4px",cursor:"pointer"},title:"Edit color"})]},t))})]}),(0,a.jsxs)("div",{className:"control-group",children:[(0,a.jsx)("h3",{children:"Actions"}),(0,a.jsx)("button",{className:"button",onClick:()=>{if(!b.current||!o)return;let e=b.current,t=e.getContext("2d");if(!t)return;let r=t.getImageData(0,0,e.width,e.height),a=r.data,n=[[a[0],a[1],a[2]],[a[(e.width-1)*4],a[(e.width-1)*4+1],a[(e.width-1)*4+2]],[a[(e.height-1)*e.width*4],a[(e.height-1)*e.width*4+1],a[(e.height-1)*e.width*4+2]]];for(let e=0;e<a.length;e+=4){let t=[a[e],a[e+1],a[e+2]];for(let r of n)if(50>Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2)+Math.pow(t[2]-r[2],2))){a[e+3]=0;break}}t.putImageData(r,0,0),d(r)},disabled:!o,children:"Remove Background"}),(0,a.jsx)("button",{className:"button",onClick:()=>{if(!b.current)return;let e=document.createElement("a");e.download="pixelated-design.png",e.href=b.current.toDataURL(),e.click()},disabled:!o,children:"Download PNG"}),(0,a.jsx)("button",{className:"button",onClick:()=>{if(t(null),s(32),i(8),d(null),h([]),g("#000000"),m(!1),f(null),b.current){let e=b.current.getContext("2d");e&&e.clearRect(0,0,b.current.width,b.current.height)}},children:"Reset"})]})]})]})}function l(){let[e,t]=(0,n.useState)(null),[r,s]=(0,n.useState)(1024),[l,i]=(0,n.useState)(7),[o,d]=(0,n.useState)(null),[c,h]=(0,n.useState)([]),[u,g]=(0,n.useState)("#000000"),[p,m]=(0,n.useState)(!1),[x,f]=(0,n.useState)(null),b=(0,n.useRef)(!0),v=(0,n.useRef)([]),j=(0,n.useRef)(null),w=(0,n.useRef)(null),k=(e,t)=>Math.sqrt(Math.pow(e.r-t.r,2)+Math.pow(e.g-t.g,2)+Math.pow(e.b-t.b,2)),C=(e,t)=>{let r=[];for(let t=0;t<e.data.length;t+=4)e.data[t+3]>128&&r.push({r:e.data[t],g:e.data[t+1],b:e.data[t+2],a:e.data[t+3]});if(0===r.length)return[];let a=new Map;r.forEach(e=>{let t={r:8*Math.round(e.r/8),g:8*Math.round(e.g/8),b:8*Math.round(e.b/8),a:e.a},r=`${t.r}-${t.g}-${t.b}`;a.has(r)?a.get(r).count++:a.set(r,{color:t,count:1})});let n=Array.from(a.values()).sort((e,t)=>t.count-e.count).slice(0,t).map(e=>({...e.color}));for(;n.length<t;){let e=r.filter(e=>!n.some(t=>16>Math.abs(e.r-t.r)&&16>Math.abs(e.g-t.g)&&16>Math.abs(e.b-t.b)));if(e.length>0){let r=Math.floor(e.length/(t-n.length+1));n.push({...e[r]})}else{let e=n[n.length%n.length];n.push({r:Math.min(255,Math.max(0,e.r+20*n.length)),g:Math.min(255,Math.max(0,e.g+20*n.length)),b:Math.min(255,Math.max(0,e.b+20*n.length)),a:e.a})}}for(let e=0;e<15;e++){let e=Array(t).fill(null).map(()=>[]);r.forEach(t=>{let r=1/0,a=0;n.forEach((e,n)=>{let s=k(t,e);s<r&&(r=s,a=n)}),e[a].push(t)});let a=!1;if(n.forEach((t,r)=>{if(e[r].length>0){let n=e[r].reduce((e,t)=>e+t.r,0)/e[r].length,s=e[r].reduce((e,t)=>e+t.g,0)/e[r].length,l=e[r].reduce((e,t)=>e+t.b,0)/e[r].length;(Math.abs(t.r-n)>1||Math.abs(t.g-s)>1||Math.abs(t.b-l)>1)&&(a=!0),t.r=n,t.g=s,t.b=l}}),!a)break}return n.map(e=>`#${Math.round(e.r).toString(16).padStart(2,"0")}${Math.round(e.g).toString(16).padStart(2,"0")}${Math.round(e.b).toString(16).padStart(2,"0")}`)};(0,n.useCallback)(()=>{if(!e||!j.current)return;let t=j.current,a=t.getContext("2d");if(!a)return;let n=Math.round(600*e.height/e.width);t.width=r,t.height=Math.round(r*e.height/e.width),t.style.width="600px",t.style.height=`${n}px`,a.imageSmoothingEnabled=!1,a.drawImage(e,0,0,t.width,t.height);let s=a.getImageData(0,0,t.width,t.height),i=v.current;(b.current||0===v.current.length)&&(h(i=C(s,l)),v.current=i,b.current=!1);let o=s.data;for(let e=0;e<o.length;e+=4)if(o[e+3]>128){let t={r:o[e],g:o[e+1],b:o[e+2],a:o[e+3]},r=1/0,a=i[0];i.forEach(e=>{let n=k(t,{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:255});n<r&&(r=n,a=e)});let n=parseInt(a.slice(1,3),16),s=parseInt(a.slice(3,5),16),l=parseInt(a.slice(5,7),16);o[e]=n,o[e+1]=s,o[e+2]=l}a.putImageData(s,0,0),d(s)},[e,r,l]);let I=(e,t)=>{let r=[...c],a=r[e];if(r[e]=t,!j.current||!o)return;let n=j.current,s=n.getContext("2d");if(!s)return;let l=s.getImageData(0,0,n.width,n.height),i=l.data,u={r:parseInt(a.slice(1,3),16),g:parseInt(a.slice(3,5),16),b:parseInt(a.slice(5,7),16)},g={r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16)};for(let e=0;e<i.length;e+=4)i[e]===u.r&&i[e+1]===u.g&&i[e+2]===u.b&&(i[e]=g.r,i[e+1]=g.g,i[e+2]=g.b);s.putImageData(l,0,0),d(l),h(r),v.current=r};return(0,a.jsxs)("div",{className:"main-content",children:[(0,a.jsx)("div",{className:`canvas-area ${e?"has-content":""}`,children:e?(0,a.jsx)("div",{className:"canvas-container",children:(0,a.jsx)("canvas",{ref:j,onClick:e=>{if(!j.current||!o)return;let t=j.current,r=t.getBoundingClientRect(),a=t.width/r.width,n=t.height/r.height,s=Math.floor((e.clientX-r.left)*a),l=Math.floor((e.clientY-r.top)*n),i=t.getContext("2d");if(!i)return;let c=i.getImageData(0,0,t.width,t.height),h=c.data,g=parseInt(u.slice(1,3),16),p=parseInt(u.slice(3,5),16),m=parseInt(u.slice(5,7),16),x=(l*t.width+s)*4;h[x]=g,h[x+1]=p,h[x+2]=m,h[x+3]=255,i.putImageData(c,0,0),d(c)},style:{imageRendering:"pixelated",cursor:"crosshair",border:"2px solid rgba(255, 255, 255, 0.3)",borderRadius:"8px"}})}):(0,a.jsxs)("div",{className:"upload-area",onDragOver:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault();let r=e.dataTransfer.files[0];if(r&&r.type.startsWith("image/")){let e=new FileReader;e.onload=e=>{let r=new Image;r.onload=()=>{b.current=!0,t(r)},r.src=e.target?.result},e.readAsDataURL(r)}},onClick:()=>w.current?.click(),children:[(0,a.jsx)("p",{children:"Click to upload or drag and drop an image"}),(0,a.jsx)("input",{ref:w,type:"file",accept:"image/*",onChange:e=>{let r=e.target.files?.[0];if(!r)return;let a=new FileReader;a.onload=e=>{let r=new Image;r.onload=()=>{b.current=!0,t(r)},r.src=e.target?.result},a.readAsDataURL(r)},className:"file-input"})]})}),(0,a.jsxs)("div",{className:"controls-panel",children:[(0,a.jsxs)("div",{className:"control-group",children:[(0,a.jsx)("h3",{children:"Resolution"}),(0,a.jsxs)("div",{className:"slider",children:[(0,a.jsx)("input",{type:"range",min:"640",max:"1024",value:r,onChange:e=>s(Number(e.target.value))}),(0,a.jsxs)("span",{children:[r,"px"]})]})]}),(0,a.jsxs)("div",{className:"control-group",children:[(0,a.jsx)("h3",{children:"Max Colors"}),(0,a.jsxs)("div",{className:"slider",children:[(0,a.jsx)("input",{type:"range",min:"3",max:"7",value:l,onChange:e=>i(Number(e.target.value))}),(0,a.jsxs)("span",{children:[l," colors"]})]})]}),c.length>0&&(0,a.jsxs)("div",{className:"control-group",children:[(0,a.jsx)("h3",{children:"Color Palette"}),(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(60px, 1fr))",gap:"10px"},children:c.map((e,t)=>(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"5px"},children:[(0,a.jsx)("div",{className:`color-swatch ${u===e?"selected":""}`,style:{backgroundColor:e,position:"relative",width:"40px",height:"40px"},onClick:()=>g(e)}),(0,a.jsx)("input",{type:"color",value:e,onChange:e=>I(t,e.target.value),style:{width:"40px",height:"20px",border:"none",borderRadius:"4px",cursor:"pointer"},title:"Edit color"})]},t))})]}),(0,a.jsxs)("div",{className:"control-group",children:[(0,a.jsx)("h3",{children:"Actions"}),(0,a.jsx)("button",{className:"button",onClick:()=>{if(!j.current||!o)return;let e=j.current,t=e.getContext("2d");if(!t)return;let r=t.getImageData(0,0,e.width,e.height),a=r.data,n=[[a[0],a[1],a[2]],[a[(e.width-1)*4],a[(e.width-1)*4+1],a[(e.width-1)*4+2]],[a[(e.height-1)*e.width*4],a[(e.height-1)*e.width*4+1],a[(e.height-1)*e.width*4+2]]];for(let e=0;e<a.length;e+=4){let t=[a[e],a[e+1],a[e+2]];for(let r of n)if(50>Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2)+Math.pow(t[2]-r[2],2))){a[e+3]=0;break}}t.putImageData(r,0,0),d(r)},disabled:!o,children:"Remove Background"}),(0,a.jsx)("button",{className:"button",onClick:()=>{if(!j.current)return;let e=document.createElement("a");e.download="pixelated-design.png",e.href=j.current.toDataURL(),e.click()},disabled:!o,children:"Download PNG"}),(0,a.jsx)("button",{className:"button",onClick:()=>{if(t(null),s(1024),i(7),d(null),h([]),g("#000000"),m(!1),f(null),b.current=!0,v.current=[],j.current){let e=j.current.getContext("2d");e&&e.clearRect(0,0,j.current.width,j.current.height)}setTimeout(()=>{let e=new Image;e.onload=()=>{b.current=!0,t(e)},e.onerror=e=>{console.error("Failed to load default sock image:",e)},e.src="/images/default-sock.png"},100)},children:"Reset"})]})]})]})}function i(){let[e,t]=(0,n.useState)("picture");return(0,a.jsxs)("div",{className:"container",children:[(0,a.jsxs)("div",{className:"header",children:[(0,a.jsx)("h1",{children:"Knitting Socks Designer"}),(0,a.jsx)("p",{children:"Create beautiful patterns and color designs for your knitting projects"})]}),(0,a.jsxs)("div",{className:"tabs",children:[(0,a.jsx)("button",{className:`tab-button ${"picture"===e?"active":""}`,onClick:()=>t("picture"),children:"Picture Design"}),(0,a.jsx)("button",{className:`tab-button ${"sock"===e?"active":""}`,onClick:()=>t("sock"),children:"Sock Color Design"})]}),(0,a.jsx)("div",{style:{display:"picture"===e?"block":"none"},children:(0,a.jsx)(s,{})}),(0,a.jsx)("div",{style:{display:"sock"===e?"block":"none"},children:(0,a.jsx)(l,{})})]})}},6190:(e,t,r)=>{Promise.resolve().then(r.bind(r,4667))},8014:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s,metadata:()=>n});var a=r(7413);r(2704);let n={title:"Knitting Socks Designer",description:"Design patterns and colors for your knitting socks"};function s({children:e}){return(0,a.jsx)("html",{lang:"en",children:(0,a.jsx)("body",{children:e})})}},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9377:()=>{},9649:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[825],()=>r(405));module.exports=a})();